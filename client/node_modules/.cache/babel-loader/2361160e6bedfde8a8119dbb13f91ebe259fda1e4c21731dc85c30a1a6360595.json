{"ast":null,"code":"import { __assign, __awaiter, __generator, __spreadArray } from \"tslib\";\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport throttle from 'lodash.throttle';\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\nexport var reactionHandlerWarning = \"Reaction handler was called, but it is missing one of its required arguments.\\nMake sure the ChannelAction and ChannelState contexts are properly set and the hook is initialized with a valid message.\";\nexport var useReactionHandler = function (message) {\n  var updateMessage = useChannelActionContext('useReactionHandler').updateMessage;\n  var _a = useChannelStateContext('useReactionHandler'),\n    channel = _a.channel,\n    channelCapabilities = _a.channelCapabilities;\n  var client = useChatContext('useReactionHandler').client;\n  var createMessagePreview = useCallback(function (add, reaction, message) {\n    var _a, _b;\n    var newReactionCounts = (message === null || message === void 0 ? void 0 : message.reaction_counts) || {};\n    var reactionType = reaction.type;\n    var hasReaction = !!newReactionCounts[reactionType];\n    if (add) {\n      newReactionCounts[reactionType] = hasReaction ? newReactionCounts[reactionType] + 1 : 1;\n    } else {\n      if (hasReaction && newReactionCounts[reactionType] > 1) {\n        newReactionCounts[reactionType]--;\n      } else {\n        delete newReactionCounts[reactionType];\n      }\n    }\n    var newReactions = add ? __spreadArray([reaction], (message === null || message === void 0 ? void 0 : message.latest_reactions) || [], true) : (_a = message.latest_reactions) === null || _a === void 0 ? void 0 : _a.filter(function (item) {\n      return !(item.type === reaction.type && item.user_id === reaction.user_id);\n    });\n    var newOwnReactions = add ? __spreadArray([reaction], (message === null || message === void 0 ? void 0 : message.own_reactions) || [], true) : (_b = message === null || message === void 0 ? void 0 : message.own_reactions) === null || _b === void 0 ? void 0 : _b.filter(function (item) {\n      return item.type !== reaction.type;\n    });\n    return __assign(__assign({}, message), {\n      latest_reactions: newReactions || message.latest_reactions,\n      own_reactions: newOwnReactions,\n      reaction_counts: newReactionCounts,\n      reaction_scores: newReactionCounts\n    });\n  }, [client.user, client.userID]);\n  var createReactionPreview = function (type) {\n    var _a;\n    return {\n      message_id: message === null || message === void 0 ? void 0 : message.id,\n      score: 1,\n      type: type,\n      user: client.user,\n      user_id: (_a = client.user) === null || _a === void 0 ? void 0 : _a.id\n    };\n  };\n  var toggleReaction = throttle(function (id, type, add) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var newReaction, tempMessage, messageResponse, _a, error_1;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!message || !channelCapabilities['send-reaction']) return [2 /*return*/];\n            newReaction = createReactionPreview(type);\n            tempMessage = createMessagePreview(add, newReaction, message);\n            _b.label = 1;\n          case 1:\n            _b.trys.push([1, 6,, 7]);\n            updateMessage(tempMessage);\n            if (!add) return [3 /*break*/, 3];\n            return [4 /*yield*/, channel.sendReaction(id, {\n              type: type\n            })];\n          case 2:\n            _a = _b.sent();\n            return [3 /*break*/, 5];\n          case 3:\n            return [4 /*yield*/, channel.deleteReaction(id, type)];\n          case 4:\n            _a = _b.sent();\n            _b.label = 5;\n          case 5:\n            messageResponse = _a;\n            updateMessage(messageResponse.message);\n            return [3 /*break*/, 7];\n          case 6:\n            error_1 = _b.sent();\n            // revert to the original message if the API call fails\n            updateMessage(message);\n            return [3 /*break*/, 7];\n          case 7:\n            return [2 /*return*/];\n        }\n      });\n    });\n  }, 1000);\n  return function (reactionType, event) {\n    return __awaiter(void 0, void 0, void 0, function () {\n      var userExistingReaction, error_2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (event === null || event === void 0 ? void 0 : event.preventDefault) {\n              event.preventDefault();\n            }\n            if (!message) {\n              return [2 /*return*/, console.warn(reactionHandlerWarning)];\n            }\n            userExistingReaction = null;\n            if (message.own_reactions) {\n              message.own_reactions.forEach(function (reaction) {\n                // own user should only ever contain the current user id\n                // just in case we check to prevent bugs with message updates from breaking reactions\n                if (reaction.user && client.userID === reaction.user.id && reaction.type === reactionType) {\n                  userExistingReaction = reaction;\n                } else if (reaction.user && client.userID !== reaction.user.id) {\n                  console.warn(\"message.own_reactions contained reactions from a different user, this indicates a bug\");\n                }\n              });\n            }\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 6,, 7]);\n            if (!userExistingReaction) return [3 /*break*/, 3];\n            return [4 /*yield*/, toggleReaction(message.id, userExistingReaction.type, false)];\n          case 2:\n            _a.sent();\n            return [3 /*break*/, 5];\n          case 3:\n            return [4 /*yield*/, toggleReaction(message.id, reactionType, true)];\n          case 4:\n            _a.sent();\n            _a.label = 5;\n          case 5:\n            return [3 /*break*/, 7];\n          case 6:\n            error_2 = _a.sent();\n            console.log({\n              error: error_2\n            });\n            return [3 /*break*/, 7];\n          case 7:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n};\n\nexport var useReactionClick = function (message, reactionSelectorRef, messageWrapperRef, closeReactionSelectorOnClick) {\n  var _a = useChannelStateContext('useReactionClick').channelCapabilities,\n    channelCapabilities = _a === void 0 ? {} : _a;\n  var _b = useState(false),\n    showDetailedReactions = _b[0],\n    setShowDetailedReactions = _b[1];\n  var hasListener = useRef(false);\n  var isReactionEnabled = channelCapabilities['send-reaction'];\n  var messageDeleted = !!(message === null || message === void 0 ? void 0 : message.deleted_at);\n  var closeDetailedReactions = useCallback(function (event) {\n    var _a;\n    if (event.target instanceof HTMLElement && ((_a = reactionSelectorRef === null || reactionSelectorRef === void 0 ? void 0 : reactionSelectorRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target)) && !closeReactionSelectorOnClick) {\n      return;\n    }\n    setShowDetailedReactions(false);\n  }, [setShowDetailedReactions, reactionSelectorRef]);\n  useEffect(function () {\n    var messageWrapper = messageWrapperRef === null || messageWrapperRef === void 0 ? void 0 : messageWrapperRef.current;\n    if (showDetailedReactions && !hasListener.current) {\n      hasListener.current = true;\n      document.addEventListener('click', closeDetailedReactions);\n      if (messageWrapper) {\n        messageWrapper.addEventListener('mouseleave', closeDetailedReactions);\n      }\n    }\n    if (!showDetailedReactions && hasListener.current) {\n      document.removeEventListener('click', closeDetailedReactions);\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n      }\n      hasListener.current = false;\n    }\n    return function () {\n      if (hasListener.current) {\n        document.removeEventListener('click', closeDetailedReactions);\n        if (messageWrapper) {\n          messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n        }\n        hasListener.current = false;\n      }\n    };\n  }, [showDetailedReactions, closeDetailedReactions, messageWrapperRef]);\n  useEffect(function () {\n    var messageWrapper = messageWrapperRef === null || messageWrapperRef === void 0 ? void 0 : messageWrapperRef.current;\n    if (messageDeleted && hasListener.current) {\n      document.removeEventListener('click', closeDetailedReactions);\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n      }\n      hasListener.current = false;\n    }\n  }, [messageDeleted, closeDetailedReactions, messageWrapperRef]);\n  var onReactionListClick = function (event) {\n    var _a;\n    (_a = event === null || event === void 0 ? void 0 : event.stopPropagation) === null || _a === void 0 ? void 0 : _a.call(event);\n    setShowDetailedReactions(function (prev) {\n      return !prev;\n    });\n  };\n  return {\n    isReactionEnabled: isReactionEnabled,\n    onReactionListClick: onReactionListClick,\n    showDetailedReactions: showDetailedReactions\n  };\n};","map":{"version":3,"names":["__assign","__awaiter","__generator","__spreadArray","useCallback","useEffect","useRef","useState","throttle","useChannelActionContext","useChannelStateContext","useChatContext","reactionHandlerWarning","useReactionHandler","message","updateMessage","_a","channel","channelCapabilities","client","createMessagePreview","add","reaction","_b","newReactionCounts","reaction_counts","reactionType","type","hasReaction","newReactions","latest_reactions","filter","item","user_id","newOwnReactions","own_reactions","reaction_scores","user","userID","createReactionPreview","message_id","id","score","toggleReaction","newReaction","tempMessage","messageResponse","error_1","label","trys","push","sendReaction","sent","deleteReaction","event","userExistingReaction","error_2","preventDefault","console","warn","forEach","log","error","useReactionClick","reactionSelectorRef","messageWrapperRef","closeReactionSelectorOnClick","showDetailedReactions","setShowDetailedReactions","hasListener","isReactionEnabled","messageDeleted","deleted_at","closeDetailedReactions","target","HTMLElement","current","contains","messageWrapper","document","addEventListener","removeEventListener","onReactionListClick","stopPropagation","call","prev"],"sources":["C:/Users/praka/OneDrive/Desktop/Tic-Tac-Toe/client/node_modules/stream-chat-react/dist/components/Message/hooks/useReactionHandler.js"],"sourcesContent":["import { __assign, __awaiter, __generator, __spreadArray } from \"tslib\";\nimport { useCallback, useEffect, useRef, useState } from 'react';\nimport throttle from 'lodash.throttle';\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\nexport var reactionHandlerWarning = \"Reaction handler was called, but it is missing one of its required arguments.\\nMake sure the ChannelAction and ChannelState contexts are properly set and the hook is initialized with a valid message.\";\nexport var useReactionHandler = function (message) {\n    var updateMessage = useChannelActionContext('useReactionHandler').updateMessage;\n    var _a = useChannelStateContext('useReactionHandler'), channel = _a.channel, channelCapabilities = _a.channelCapabilities;\n    var client = useChatContext('useReactionHandler').client;\n    var createMessagePreview = useCallback(function (add, reaction, message) {\n        var _a, _b;\n        var newReactionCounts = (message === null || message === void 0 ? void 0 : message.reaction_counts) || {};\n        var reactionType = reaction.type;\n        var hasReaction = !!newReactionCounts[reactionType];\n        if (add) {\n            newReactionCounts[reactionType] = hasReaction ? newReactionCounts[reactionType] + 1 : 1;\n        }\n        else {\n            if (hasReaction && newReactionCounts[reactionType] > 1) {\n                newReactionCounts[reactionType]--;\n            }\n            else {\n                delete newReactionCounts[reactionType];\n            }\n        }\n        var newReactions = add\n            ? __spreadArray([reaction], ((message === null || message === void 0 ? void 0 : message.latest_reactions) || []), true) : (_a = message.latest_reactions) === null || _a === void 0 ? void 0 : _a.filter(function (item) { return !(item.type === reaction.type && item.user_id === reaction.user_id); });\n        var newOwnReactions = add\n            ? __spreadArray([reaction], ((message === null || message === void 0 ? void 0 : message.own_reactions) || []), true) : (_b = message === null || message === void 0 ? void 0 : message.own_reactions) === null || _b === void 0 ? void 0 : _b.filter(function (item) { return item.type !== reaction.type; });\n        return __assign(__assign({}, message), { latest_reactions: newReactions || message.latest_reactions, own_reactions: newOwnReactions, reaction_counts: newReactionCounts, reaction_scores: newReactionCounts });\n    }, [client.user, client.userID]);\n    var createReactionPreview = function (type) {\n        var _a;\n        return ({\n            message_id: message === null || message === void 0 ? void 0 : message.id,\n            score: 1,\n            type: type,\n            user: client.user,\n            user_id: (_a = client.user) === null || _a === void 0 ? void 0 : _a.id,\n        });\n    };\n    var toggleReaction = throttle(function (id, type, add) { return __awaiter(void 0, void 0, void 0, function () {\n        var newReaction, tempMessage, messageResponse, _a, error_1;\n        return __generator(this, function (_b) {\n            switch (_b.label) {\n                case 0:\n                    if (!message || !channelCapabilities['send-reaction'])\n                        return [2 /*return*/];\n                    newReaction = createReactionPreview(type);\n                    tempMessage = createMessagePreview(add, newReaction, message);\n                    _b.label = 1;\n                case 1:\n                    _b.trys.push([1, 6, , 7]);\n                    updateMessage(tempMessage);\n                    if (!add) return [3 /*break*/, 3];\n                    return [4 /*yield*/, channel.sendReaction(id, { type: type })];\n                case 2:\n                    _a = _b.sent();\n                    return [3 /*break*/, 5];\n                case 3: return [4 /*yield*/, channel.deleteReaction(id, type)];\n                case 4:\n                    _a = _b.sent();\n                    _b.label = 5;\n                case 5:\n                    messageResponse = _a;\n                    updateMessage(messageResponse.message);\n                    return [3 /*break*/, 7];\n                case 6:\n                    error_1 = _b.sent();\n                    // revert to the original message if the API call fails\n                    updateMessage(message);\n                    return [3 /*break*/, 7];\n                case 7: return [2 /*return*/];\n            }\n        });\n    }); }, 1000);\n    return function (reactionType, event) { return __awaiter(void 0, void 0, void 0, function () {\n        var userExistingReaction, error_2;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    if (event === null || event === void 0 ? void 0 : event.preventDefault) {\n                        event.preventDefault();\n                    }\n                    if (!message) {\n                        return [2 /*return*/, console.warn(reactionHandlerWarning)];\n                    }\n                    userExistingReaction = null;\n                    if (message.own_reactions) {\n                        message.own_reactions.forEach(function (reaction) {\n                            // own user should only ever contain the current user id\n                            // just in case we check to prevent bugs with message updates from breaking reactions\n                            if (reaction.user && client.userID === reaction.user.id && reaction.type === reactionType) {\n                                userExistingReaction = reaction;\n                            }\n                            else if (reaction.user && client.userID !== reaction.user.id) {\n                                console.warn(\"message.own_reactions contained reactions from a different user, this indicates a bug\");\n                            }\n                        });\n                    }\n                    _a.label = 1;\n                case 1:\n                    _a.trys.push([1, 6, , 7]);\n                    if (!userExistingReaction) return [3 /*break*/, 3];\n                    return [4 /*yield*/, toggleReaction(message.id, userExistingReaction.type, false)];\n                case 2:\n                    _a.sent();\n                    return [3 /*break*/, 5];\n                case 3: return [4 /*yield*/, toggleReaction(message.id, reactionType, true)];\n                case 4:\n                    _a.sent();\n                    _a.label = 5;\n                case 5: return [3 /*break*/, 7];\n                case 6:\n                    error_2 = _a.sent();\n                    console.log({ error: error_2 });\n                    return [3 /*break*/, 7];\n                case 7: return [2 /*return*/];\n            }\n        });\n    }); };\n};\nexport var useReactionClick = function (message, reactionSelectorRef, messageWrapperRef, closeReactionSelectorOnClick) {\n    var _a = useChannelStateContext('useReactionClick').channelCapabilities, channelCapabilities = _a === void 0 ? {} : _a;\n    var _b = useState(false), showDetailedReactions = _b[0], setShowDetailedReactions = _b[1];\n    var hasListener = useRef(false);\n    var isReactionEnabled = channelCapabilities['send-reaction'];\n    var messageDeleted = !!(message === null || message === void 0 ? void 0 : message.deleted_at);\n    var closeDetailedReactions = useCallback(function (event) {\n        var _a;\n        if (event.target instanceof HTMLElement &&\n            ((_a = reactionSelectorRef === null || reactionSelectorRef === void 0 ? void 0 : reactionSelectorRef.current) === null || _a === void 0 ? void 0 : _a.contains(event.target)) &&\n            !closeReactionSelectorOnClick) {\n            return;\n        }\n        setShowDetailedReactions(false);\n    }, [setShowDetailedReactions, reactionSelectorRef]);\n    useEffect(function () {\n        var messageWrapper = messageWrapperRef === null || messageWrapperRef === void 0 ? void 0 : messageWrapperRef.current;\n        if (showDetailedReactions && !hasListener.current) {\n            hasListener.current = true;\n            document.addEventListener('click', closeDetailedReactions);\n            if (messageWrapper) {\n                messageWrapper.addEventListener('mouseleave', closeDetailedReactions);\n            }\n        }\n        if (!showDetailedReactions && hasListener.current) {\n            document.removeEventListener('click', closeDetailedReactions);\n            if (messageWrapper) {\n                messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n            }\n            hasListener.current = false;\n        }\n        return function () {\n            if (hasListener.current) {\n                document.removeEventListener('click', closeDetailedReactions);\n                if (messageWrapper) {\n                    messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n                }\n                hasListener.current = false;\n            }\n        };\n    }, [showDetailedReactions, closeDetailedReactions, messageWrapperRef]);\n    useEffect(function () {\n        var messageWrapper = messageWrapperRef === null || messageWrapperRef === void 0 ? void 0 : messageWrapperRef.current;\n        if (messageDeleted && hasListener.current) {\n            document.removeEventListener('click', closeDetailedReactions);\n            if (messageWrapper) {\n                messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n            }\n            hasListener.current = false;\n        }\n    }, [messageDeleted, closeDetailedReactions, messageWrapperRef]);\n    var onReactionListClick = function (event) {\n        var _a;\n        (_a = event === null || event === void 0 ? void 0 : event.stopPropagation) === null || _a === void 0 ? void 0 : _a.call(event);\n        setShowDetailedReactions(function (prev) { return !prev; });\n    };\n    return {\n        isReactionEnabled: isReactionEnabled,\n        onReactionListClick: onReactionListClick,\n        showDetailedReactions: showDetailedReactions,\n    };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}